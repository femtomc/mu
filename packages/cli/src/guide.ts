export function guideText(): string {
	return [
		"mu guide - in-CLI documentation",
		"",
		"Goal: you should not have to leave the CLI to understand what mu supports.",
		"",
		"Quickstart",
		"  1) Start a run (auto-initializes `.mu/`, creates a root issue, runs the DAG loop):",
		'       mu run "Break down this goal and execute it"',
		"",
		"  2) See what exists / what is ready:",
		"       mu status",
		"       mu issues ready --root <root-id>",
		"",
		"  3) Resume an interrupted run:",
		"       mu resume <root-id>",
		"",
		"Command Overview",
		"  mu status                       Human summary (or JSON with --json)",
		"  mu store <subcmd>               Inspect .mu files (paths/ls/tail)",
		"  mu issues <subcmd>              Work item operations",
		"  mu forum <subcmd>               Coordination message operations",
		"  mu run <prompt...>              Start a new run",
		"  mu resume <root-id>             Resume a run",
		"  mu chat [--message TEXT]        Talk to the mu operator",
		"  mu replay <id|path>             Print a logged run",
		"  mu control <subcmd>             Messaging integration identity/config",
		"  mu serve                        Start API + web UI + terminal operator session",
		"  mu login                        Authenticate with an AI provider",
		"",
		".mu Store Layout",
		"  mu stores all state at the git repo root in `.mu/`:",
		"    .mu/",
		"      .gitignore    Auto-generated; ignores all local runtime state",
		"      issues.jsonl   Issue DAG nodes (one JSON object per line)",
		"      forum.jsonl    Forum messages (one JSON object per line)",
		"      events.jsonl   Append-only event log (auditing / derived views)",
		"      logs/          Run logs (grouped by root issue id)",
		"      roles/         Role prompts (orchestrator.md, worker.md)",
		"",
		"  Logs are written under:",
		"    .mu/logs/<root-id>/<issue-id>*.jsonl",
		"",
		"Common Workflows",
		"",
		"  Status",
		"    mu status",
		"    mu status --json --pretty",
		"",
		"  Store inspection (.mu)",
		"    mu store paths",
		"    mu store ls --pretty",
		"    mu store tail events --limit 20",
		"    mu store tail cp_operator_turns --limit 20 --json --pretty",
		"",
		"  Work items",
		'    mu issues create "Title" --body "Details" --priority 2 --tag node:agent',
		"    mu issues list --status open --limit 20",
		"    mu issues ready --root <root-id>",
		"    mu issues get <id-or-prefix> --pretty",
		"    mu issues update <id> --status in_progress",
		"    mu issues close <id> --outcome success",
		"",
		"  Forum",
		'    mu forum post issue:<id> -m "status update" --author worker',
		"    mu forum read issue:<id> --limit 20",
		"    mu forum topics --prefix issue: --limit 20",
		"",
		"  Run / Resume",
		"    mu run <prompt...> --max-steps 20",
		"    mu resume <root-id> --max-steps 20",
		"",
		"    Model overrides:",
		'      mu run "..." --provider openai-codex --model gpt-5.3-codex --reasoning high',
		"",
		"    Non-interactive / machine-readable:",
		'      mu run "..." --json',
		"",
		"    Raw backend stream (JSONL):",
		'      mu run "..." --raw-stream',
		"",
		"  Operator Chat",
		"    mu chat",
		'    mu chat --message "What is ready right now?"',
		'    mu chat --message "How do I set up Slack control-plane webhooks?" --json',
		"",
		"    Operator behavior is configured in .mu/config.json",
		"    Use /mu-setup and mu control status for guided configuration",
		"",
		"  Replay",
		"    mu replay <root-id>/<issue-id>",
		"    mu replay .mu/logs/<root-id>/<issue-id>.jsonl",
		"",
		"  Messaging integrations (identity & config)",
		"    mu control status                     Summary of identities, policy, adapters",
		"    mu control status --json --pretty      Structured output",
		"    mu control link --channel telegram --actor-id 123 --tenant-id bot",
		"    mu control link --channel slack --actor-id U01 --tenant-id T01 --role viewer",
		"    mu control identities --pretty         List active bindings",
		"    mu control identities --all --pretty   Include inactive bindings",
		"    mu control unlink <binding-id>          Self-unlink",
		"    mu control unlink <binding-id> --revoke Admin revocation",
		"    mu control diagnose-operator            Inspect operator turn parse/runtime health",
		"",
		"    Workflow: link → serve → use",
		"      1) mu control link --channel telegram --actor-id 99 --tenant-id bot",
		"      2) mu serve  (picks up linked identities automatically)",
		"      3) Send commands via the linked channel",
		"",
		"    Roles:",
		"      operator     Full access (read, write, execute, admin)",
		"      contributor   Read + write + execute (no admin)",
		"      viewer        Read-only",
		"",
		"  Serve (API + Web UI + terminal operator session)",
		"    mu serve",
		"    mu serve --port 3000 --no-open",
		"    (mu serve immediately attaches terminal operator session; type /exit to stop)",
		"",
		"  Login / Auth",
		"    mu login --list",
		"    mu login openai-codex",
		"",
		"    Environment variable auth (no login needed):",
		"      OPENAI_API_KEY, ANTHROPIC_API_KEY, GOOGLE_API_KEY, etc.",
		"",
		"    Telegram bot replies require control_plane.adapters.telegram.bot_token in .mu/config.json.",
		"",
		"Roles (High Level)",
		"  mu supports role-tagged issues to coordinate work:",
		"    orchestrator: breaks down goals, assigns work, integrates results",
		"    worker: executes a single atomic issue end-to-end",
		"",
		"  Tip: use `mu issues ready --root <root-id>` to find ready leaf work tagged for agents.",
		"",
		"Troubleshooting",
		"  Store missing / empty:",
		"    Run `mu run` or `mu serve` once to auto-create `.mu/`.",
		"",
		"  Ambiguous id prefix:",
		"    Use a longer prefix or the full id. Try: `mu issues list --limit 20`.",
		"",
		"  A run failed or got interrupted:",
		"    Use the recovery hints printed by `mu run`/`mu resume`, or try:",
		"      mu replay <root-id>/<issue-id>",
		"      mu resume <root-id> --max-steps 20",
		"",
		"  Chat in scripts/CI:",
		'    Use one-shot mode: `mu chat --message "..."` (interactive mode requires a TTY).',
		"",
		"  Headless/SSH serve:",
		"    Use `mu serve --no-open` and port-forward the printed ports.",
		"    The same terminal also hosts the operator session.",
		"",
		"  Too much ANSI color:",
		"    Set `NO_COLOR=1` (or unset it to re-enable color).",
	].join("\n");
}
